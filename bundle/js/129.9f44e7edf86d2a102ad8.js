/*! For license information please see 129.9f44e7edf86d2a102ad8.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[129],{78671:(t,s,i)=>{i.d(s,{I:()=>n});const n="spaces.sdk.qa"},76924:(t,s,i)=>{i.r(s),i.d(s,{ResizeProperty:()=>r,default:()=>f});var n=i(75578),e=i(37105),a=i(73927),o=i(89103);class h extends o.QB{constructor(t,s){super(),this.x=t,this.y=s}}var r,c=i(31093),u=i(52018),d=i(58095),l=i(20599);class p extends u.t{}!function(t){t.left="left",t.top="top",t.width="width",t.height="height"}(r||(r={}));const g={[r.width]:"width",[r.height]:"height",[r.top]:"top",[r.left]:"left"};class f extends n.n{constructor(){super(...arguments),this.name="canvas",this.getNewX=()=>0,this.getNewY=()=>0,this.getNewWidth=t=>t.width,this.getNewHeight=t=>t.height,this.activeTransitions=[],this.activeTransitionMap={left:null,top:null,width:null,height:null},this.onResize=t=>{t.propertyName in r&&(this.resolveActiveTransition(t.propertyName),this._canvas.style.transitionDuration=this.stringifyTransitionDurations())},this.onContainerResize=()=>{this.transitionDurations.left=this.transitionDurations.top=this.transitionDurations.width=this.transitionDurations.height="0s",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition(),this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()}}async init(t,s){if(this.engine=s,!t.container)throw new p;this.container=t.container,this.container.appendChild(t.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=t.canvas,this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push(s.subscribe(d.P,this.onContainerResize),this.makeTransitionEndSubscription());for(const t of this.bindings)t.renew();this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new e.p(this.canvasBounds.width,this.canvasBounds.height,this._canvas),s.market.register(e.p,this.data),this.cameraData=await this.engine.market.waitForData(l.M)}async resizeCanvas(t){return 0===t.length?[]:(this.cameraData&&!this.cameraData.canTransition()&&await this.cameraData.transition.promise,this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),t.forEach((t=>{const{property:s,setDimension:i,duration:n=0}=t,e=g[s],a=this._canvas.style[e];switch(s){case r.height:this.setHeight(i,n);break;case r.width:this.setWidth(i,n);break;case r.top:this.setY(i,n);break;case r.left:this.setX(i,n)}if(this._canvas.style[e]!==a&&n>0){const t=new c.i;t.then((()=>{clearTimeout(i)}));const i=setTimeout((()=>{this.resolveActiveTransition(s)}),n+500);this.activeTransitionMap[s]=t,this.activeTransitions.push(s)}})),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),this.getTransitionPromise())}makeTransitionEndSubscription(){let t=!1;return{renew:()=>{t||(this.element.addEventListener("transitionend",this.onResize),t=!0)},cancel:()=>{t&&(this.element.removeEventListener("transitionend",this.onResize),t=!1)}}}dispose(t){super.dispose(t)}get element(){return this._canvas}get width(){return this.canvasBounds.width}get height(){return this.canvasBounds.height}get x(){return this.canvasBounds.left}get y(){return this.canvasBounds.top}onUpdate(){const t=this.container.getBoundingClientRect(),s=this.containerHasChanged(t);s&&(this.containerBounds=t,this.updateTransitions()),(s||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());const i=this.data.width!==this.width||this.data.height!==this.height,n=this.data.x!==this.x||this.data.y!==this.y;i&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.engine.broadcast(new a.h(this.width,this.height))),n&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.engine.broadcast(new h(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))}containerHasChanged(t){return t.left!==this.containerBounds.left||t.top!==this.containerBounds.top||t.width!==this.containerBounds.width||t.height!==this.containerBounds.height}setX(t,s=0){this.getNewX="number"==typeof t?()=>t:t,this.transitionDurations.left=`${s}ms`,this.updateTransitions()}setY(t,s=0){this.getNewY="number"==typeof t?()=>t:t,this.transitionDurations.top=`${s}ms`,this.updateTransitions()}setWidth(t,s=0){this.getNewWidth="number"==typeof t?()=>t:t,this.transitionDurations.width=`${s}ms`,this.updateTransitions()}setHeight(t,s=0){this.getNewHeight="number"==typeof t?()=>t:t,this.transitionDurations.height=`${s}ms`,this.updateTransitions()}screenToCanvasPoint(t,s){return{x:t-this.x,y:s-this.y}}getTransitionPromise(){return Promise.all(this.activeTransitions.map((t=>this.activeTransitionMap[t])).filter((t=>!!t)))}updateTransitions(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()}applySize(){this._canvas.style.width=`${this.getNewWidth(this.containerBounds)}px`,this._canvas.style.height=`${this.getNewHeight(this.containerBounds)}px`}applyPosition(){this._canvas.style.left=`${this.getNewX(this.containerBounds)}px`,this._canvas.style.top=`${this.getNewY(this.containerBounds)}px`}stringifyTransitionDurations(){return Object.keys(this.transitionDurations).map((t=>this.transitionDurations[t])).join(",")}resolveActiveTransition(t){this.canvasBounds=this._canvas.getBoundingClientRect();const s=this.activeTransitions.indexOf(t);-1!==s&&this.activeTransitions.splice(s,1);const i=this.activeTransitionMap[t];i&&i.resolve(),this.activeTransitionMap[t]=null,this.transitionDurations[t]="0s"}hasActiveTransitions(){return this.activeTransitions.length>0}}},58095:(t,s,i)=>{i.d(s,{H:()=>a,P:()=>e});var n=i(89103);class e extends n.QB{constructor(t,s){super(),this.width=t,this.height=s}}class a extends n.QB{constructor(t){super(),this.orientation=t}}},99622:(t,s,i)=>{i.d(s,{q:()=>h});var n=i(10843),e=i(99694),a=i.n(e),o=i(67536);class h{constructor(){this.event="mp_feature_usage",this.name="feature-usage-handler",this.handlers=[{msgType:o.P,func:(t,s)=>{const i=n.Ay.for(this),e=a()(s.data);i.debug(`tracking ${this.event} [${e.event_name}] event`,{payload:e}),t.track(this.event,e)}}]}}},67536:(t,s,i)=>{i.d(s,{P:()=>e});var n=i(89103);class e extends n.QB{constructor(t){super(),this.data=t}}},46957:(t,s,i)=>{i.d(s,{b:()=>o,d:()=>a});var n=i(31002),e=i(72268);const a=t=>t instanceof n.rX?t.button===e.m.PRIMARY:t.buttons===e.O.PRIMARY,o=(t,s)=>{var i;const n=(null===(i=s.parentElement)||void 0===i?void 0:i.clientWidth)||0,e=s.offsetLeft,a=s.offsetWidth,o=Math.max(60,Math.min(90,.08*a));return 0===e&&t>0&&t<o||!(e+a<n)&&t>n-o}},41837:(t,s,i)=>{i.d(s,{QZ:()=>a,To:()=>c,bV:()=>u,hR:()=>e,kC:()=>h,sN:()=>o,wx:()=>r,z:()=>d});var n=i(89103);class e extends n.QB{constructor(t){super(),this.data=t}}class a extends n.QB{constructor(t){super(),this.data=t}}class o extends n.QB{}class h extends n.QB{constructor(t,s){super(),this.sid=t,this.text=s}}class r extends n.QB{constructor(t,s,i){super(),this.sid=t,this.oldText=s,this.newText=i}}class c extends n.QB{constructor(t){super(),this.data=t}}class u extends n.QB{constructor(t){super(),this.data=t}}class d extends n.QB{constructor(t,s,i){super(),this.opened=t,this.viewmode=s,this.count=i}}n.QB},95522:(t,s,i)=>{i.d(s,{N:()=>e});var n=i(89103);class e extends n.QB{constructor(t){super(),this.rating=t}}},23431:(t,s,i)=>{var n;i.d(s,{I:()=>n}),function(t){t[t.RoomLabels=0]="RoomLabels",t[t.Normal=1]="Normal"}(n||(n={}))},58687:(t,s,i)=>{i.d(s,{M:()=>a});var n=i(84710),e=i(98848);class a extends n.B{constructor(t={}){super(),this.name="storage-data",this.lastPublished=null,this.transactionState=e.i.IDLE,this.isInProcessingSubState=!1,Object.assign(this,t)}setTransactionState(t){if(t!==this.transactionState){if(![this.transactionState,t].includes(e.i.IDLE))throw new Error(`Cannot transition from ${this.transactionState} to ${t}`);this.transactionState=t,this.transactionState===e.i.IDLE&&(this.isInProcessingSubState=!1),this.commit()}}setProcessingSubState(t){if(t&&this.transactionState===e.i.IDLE)throw new Error("Cannot be in a Processing sub-state while Transaction State is Idle");this.isInProcessingSubState=t,this.commit()}}},98848:(t,s,i)=>{var n,e;i.d(s,{i:()=>n,w:()=>e}),function(t){t.IDLE="idle",t.SAVING="saving"}(n||(n={})),function(t){t.ON="on",t.BEFORE="before",t.AFTER="after"}(e||(e={}))},85846:(t,s,i)=>{i.d(s,{xO:()=>r});var n,e=i(48539),a=i(50380);!function(t){t.GET="GET",t.POST="POST",t.PATCH="PATCH",t.PUT="PUT",t.DELETE="DELETE",t.OPTIONS="OPTIONS"}(n||(n={}));class o{constructor(){this._options={responseType:"json"}}get options(){const t=this._options;return t.headers=(0,a.v)(this.url,this._options.headers||{}),t}}class h extends o{constructor(t){super(),this.config=t,this.url=t.path}async read(){const{deserialize:t}=this.config;let s=null;return this.config.cachedData&&this.config.cachedData.data?s=this.config.cachedData.data:(s=await this.config.queue.get(this.config.path,this.options),this.config.cachedData&&(this.config.cachedData.data=s)),t(s)}clearCache(){this.config.cachedData&&(this.config.cachedData.data=null)}}class r extends h{constructor(t){super(t),this.config=t,this.acceptsPartial=!1,this.config.batchUpdate="batchUpdate"in this.config&&this.config.batchUpdate}async create(t){throw Error("Not implemented")}updateBatch(t,s){const{serialize:i}=this.config,e=[],a=[...new Set([...Object.keys(t),...Object.keys(s)])];for(const i of a){t[i]||s[i]||e.push(this.config.queue.delete(`${this.config.path}/${i}`,this.options))}const o=i(t,s),h=Object.assign(Object.assign({},this.options),{body:o});return e.push(this.config.queue.request(this.config.httpMethod||n.POST,this.config.path,h)),Promise.all(e)}updateInternal(t,s){const{serialize:i}=this.config,a=[],o=Object.assign({},this.options),h=Object.keys(t),r=Object.keys(s),c=(0,e.ij)(h.concat(r));for(const e in c){const h=c[e],r=t[h]||s[h];if(r){const t={};t[h]=r;const e={},c=s[h];c&&(e[h]=c);const u=i(t,e);o.body=u,a.push(this.config.queue.request(this.config.httpMethod||n.POST,this.config.path,o))}else a.push(this.config.queue.delete(`${this.config.path}/${h}`,this.options))}return Promise.all(a)}async update(t,s){this.clearCache(),await(this.config.batchUpdate?this.updateBatch(t,s||{}):this.updateInternal(t,s||{}))}async delete(t){throw Error("Not implemented")}}},16964:(t,s,i)=>{i.d(s,{l:()=>e});var n=i(68909);class e extends n.Mesh{constructor(t=100,s,i,n=1){super(s,i),this.capacity=t,this.numInstances=n,this.topIdx=0,this.indexMap=new Map,this.viewMap=new Map,this.frustumCulled=!1,this.matrixAutoUpdate=!1}allocInstance(t){const s=this.topIdx;return this.topIdx++,this.topIdx>=this.capacity&&this.doubleBufferCapacities(),this.indexMap.set(t,s),this.viewMap.set(s,t),this.geometry.instanceCount=this.topIdx*this.numInstances,s}removeInstance(t){const s=this.indexMap.get(t);if(null!=s){const i=this.topIdx-1;this.moveInstanceData(i,s),this.indexMap.delete(t),this.viewMap.delete(s);const n=this.viewMap.get(i);null!=n&&(this.indexMap.set(n,s),this.viewMap.set(s,n)),this.topIdx--,this.geometry.instanceCount=this.topIdx*this.numInstances}}removeAllInstances(){this.topIdx=0,this.geometry.instanceCount=0,this.indexMap.clear(),this.viewMap.clear()}moveInstanceData(t,s){if(t!==s)for(const i of this.allAttributeNames){const e=this[i];if(e instanceof n.InstancedBufferAttribute){const i=e.itemSize;for(let n=0;n<this.numInstances;n++)for(let a=0;a<i;a++)e.array[i*(this.numInstances*s+n)+a]=e.array[i*(this.numInstances*t+n)+a];e.needsUpdate=!0}}}get allAttributeNames(){const t=[];for(const s in this)this[s]instanceof n.InstancedBufferAttribute&&t.push(s);return t}*getIndices(t){const s=this.indexMap.get(t);if(null!=s)for(let t=0;t<this.numInstances;t++)yield this.numInstances*s+t}get capacityForAllInstances(){return this.capacity*this.numInstances}doubleBufferCapacities(){this.capacity=2*this.capacity;const t=[];for(const s of this.allAttributeNames){const i=this[s];i instanceof n.InstancedBufferAttribute&&t.push([s,this.expandCapacityForAttr(i)])}this.geometry.dispose();for(const[s,i]of t)this[s]=i,this.geometry.setAttribute(s,i)}expandCapacityForAttr(t){const s=t.array instanceof Uint8Array,i=!!s,e=new(s?Uint8Array:Float32Array)(this.capacity*t.itemSize*this.numInstances);return e.set(t.array),new n.InstancedBufferAttribute(e,t.itemSize,i)}}},78498:(t,s,i)=>{function n(t){return{x:t.x,y:t.y,z:t.z}}function e(t){return{x:t.x||t._x,y:t.y||t._y,z:t.z||t._z,w:t.w||t._w}}i.d(s,{I:()=>n,p:()=>e})},20431:(t,s,i)=>{i.d(s,{lk:()=>a,zM:()=>e});const n=new(i(10843).Ay)("util-browser"),e=function(t,s){if(!("localStorage"in window))return s;let i;try{i=window.localStorage.getItem(t)}catch(t){return n.debug(t),s}return null===i?s:"boolean"==typeof s?"true"===i:"number"==typeof s?parseFloat(i):i},a=function(t,s){try{window.localStorage.setItem(t,s)}catch(t){n.error(t)}}}}]);